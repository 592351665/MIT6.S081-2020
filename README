miggon 

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/15e02f3ea5ff43f6b5f471974b42e33e.png#pic_center)

## 1.Large files

目的：通过混合索引机制添加二级索引页表，增大文件大小

文件系统中，磁盘和内存中数据结构为 dinode\inode；inode中存储的为数据所在盘块地址，前12个盘块数据可直接查询到，称为 直接记录盘块；其余存放在1级索引表中，1024/4=256，共256个盘块地址；

1.bmap:

bp = bread(ip->dev, addr);返回一个缓冲区缓存（双向链表）中的缓存块，缓存块中的data即为一级索引盘块的地址内容（256个）；

log_write(bp)的作用？将修改后的间接块写入日志，确保崩溃恢复时的一致性

2.itrunc:两重释放；
